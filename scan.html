<!DOCTYPE html>
<html>
<head>
  <title>Object Detection App</title>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>

  <style>
    body { text-align: center; font-family: Arial; }
    video, canvas { width: 90%; max-width: 400px; }
    #label { font-size: 24px; font-weight: bold; margin-top: 10px; }
  </style>
</head>

<body>
  <h2>Mobile Camera Object Detection</h2>

  <video id="video" autoplay playsinline></video>
  <canvas id="canvas"></canvas>
  <p id="label">Detecting...</p>

  <script>
    const video = document.getElementById("video");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const labelText = document.getElementById("label");

    async function startCamera() {
      const stream = await navigator.mediaDevices.getUserMedia({
        video: { facingMode: "environment" }
      });
      video.srcObject = stream;

      return new Promise(resolve => {
        video.onloadedmetadata = () => resolve();
      });
    }

    async function startApp() {
      await startCamera();
      const model = await cocoSsd.load();

      setInterval(async () => {
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;

        ctx.drawImage(video, 0, 0);

        const predictions = await model.detect(video);

        if (predictions.length > 0) {
          const p = predictions[0];
          labelText.innerText = "Detected: " + p.class;

          ctx.strokeStyle = "red";
          ctx.lineWidth = 3;
          ctx.strokeRect(...p.bbox);

          ctx.fillStyle = "red";
          ctx.font = "18px Arial";
          ctx.fillText(
            p.class + " (" + Math.round(p.score * 100) + "%)",
            p.bbox[0],
            p.bbox[1] - 5
          );
        } else {
          labelText.innerText = "No object detected";
        }
      }, 200);
    }

    startApp();
  </script>
</body>
</html>
